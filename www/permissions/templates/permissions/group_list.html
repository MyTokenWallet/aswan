{% extends 'base.html' %}
{% load render_table from django_tables2 %}
{% load staticfiles %}

{% block header %}
<a href="javascript:;" class="active">Group Management</a>
{% endblock %}

{% block action %}
<a class="roll-nav roll-right extra-right-btns pull-right" href="{% url 'permissions:group_create' %}">
    <i class="fa fa-plus"></i>
    Add new points
</a>
{% endblock %}

{% block main %}
<div class="wrapper wrapper-content">
    <div class="extra-box-content">
        {% render_table table "table.html" %}
    </div>
</div>
{% endblock %}


{% block js %}
{{ block.super }}
<script type="text/javascript">
    $(".perms-group-delete").on("click", function () {
        var $this = $(this);
        var entity_id = $this.data("entity_id");
        swal({
            title: "Are you sure you want to delete it",
            type: "warning",
            showCancelButton: true,
            confirmButtonClass: "btn-danger",
            confirmButtonColor: "#ff6700",
            confirmButtonText: "delete",
            cancelButtonText: "cancel",
            closeOnConfirm: false,
            closeOnCancel: true
        }, function (isConfirm) {
            if (isConfirm) {
                $.ajax({
                    method: "DELETE",
                    url: "{{ request.get_full_path }}",
                    data: {entity_id: entity_id},
                    dataType: "json",
                    success: function (data) {
                        if (data.state) {
                            swal({
                                title: "delete succeeded!",
                                type: "success",
                                timer: 800,
                                showCancelButton: false,
                                showConfirmButton: false
                            });
                            $this.parent().parent().css("display", "none");
                        } else {
                            swal({
                                title: "failed to delete!",
                                type: "danger",
                            });
                        }
                    }
                });
            }
        });
    });
</script>
{% endblock %}
